---
import BaseLayout from "@/layouts/BaseLayout.astro";
import Hero from "@/components/sections/Hero.astro";
import Features from "@/components/sections/Features.astro";
import CTA from "@/components/sections/CTA.astro";
import TechShowcase from "@/components/sections/TechShowcase.astro";
import directus from "@/lib/directus";
import { readSingleton } from "@directus/sdk";

let homepage: any = null;
try {
  homepage = await directus.request(readSingleton("homepage"));
} catch {
  // Collection empty or doesn't exist — use defaults
}
---

<BaseLayout title="Arcate Labs" description="Arcate Labs builds automation systems — custom workflows, SEO infrastructure, and AI-powered systems designed to run without you.">
  <Hero
    title={homepage?.headline ?? "We build automation systems that do the work for you."}
    subtitle={homepage?.tagline ?? "Custom workflows, SEO infrastructure, and AI-powered systems — designed to run without you babysitting them."}
    primaryCta={{ href: homepage?.hero_primary_cta_link ?? "/contact", label: homepage?.hero_primary_cta_label ?? "Start a Conversation" }}
    secondaryCta={{ href: homepage?.hero_secondary_cta_link ?? "/solutions", label: homepage?.hero_secondary_cta_label ?? "See Our Solutions" }}
  />

  <!-- What We Do -->
  <section class="py-24">
    <div class="container max-w-3xl mx-auto px-4 sm:px-6">
      <h2 class="text-3xl font-bold tracking-tight md:text-4xl mb-8">What We Do</h2>
      <div class="space-y-6 text-lg text-muted-foreground leading-relaxed">
        <p>
          Arcate Labs is an automation-first development studio. We build the systems that connect your tools, generate your leads, and handle the work your team shouldn't be doing manually.
        </p>
        <p>
          We started by building automations for SEO — content pipelines, programmatic sites, data enrichment workflows. It turns out those same systems solve problems in every industry. Now we build automation for anyone who's tired of doing things the hard way.
        </p>
      </div>
    </div>
  </section>

  <Features
    title={homepage?.features_title ?? "Capabilities"}
    subtitle={homepage?.features_subtitle ?? "Scalable systems across search, engineering, and automation."}
    features={[
      { title: "SEO & Search Architecture", description: "Designing scalable search structures that align with user intent and support long-term discoverability.", icon: "globe" },
      { title: "Programmatic Site Development", description: "Building flexible, data-driven sites designed to scale across markets, locations, or service categories.", icon: "zap" },
      { title: "Workflow Automation", description: "Automating how demand is captured, filtered, and delivered to reduce friction and manual handling.", icon: "chart" },
      { title: "Data-Driven Growth Systems", description: "Using performance data to inform system structure, iteration, and expansion.", icon: "shield" },
      { title: "Custom Demand Infrastructure", description: "Designing purpose-built systems tailored to specific industries, constraints, or operational goals.", icon: "lock" },
    ]}
  />

  <!-- Two Practices, One Engine -->
  <section class="py-24">
    <div class="container max-w-5xl mx-auto px-4 sm:px-6">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-bold leading-[1.1] md:text-5xl">Two Practices, One Engine</h2>
      </div>
      <div class="grid gap-8 md:grid-cols-2">
        <a href="/solutions/automation" class="group rounded-lg border bg-card p-8 transition-all hover:bg-accent/50 hover:border-primary/50 hover:shadow-lg">
          <div class="mb-4 inline-block px-3 py-1 bg-primary/10 text-primary text-sm font-medium rounded-full">
            The Engine
          </div>
          <h3 class="text-2xl font-bold mb-3 group-hover:text-primary transition-colors">Automation Engineering</h3>
          <p class="text-muted-foreground mb-4">Custom workflows, system integrations, and AI-powered automation that eliminate manual work and connect your tools into one system.</p>
          <span class="text-sm font-medium text-primary group-hover:underline">Learn more &rarr;</span>
        </a>
        <a href="/solutions/seo" class="group rounded-lg border bg-card p-8 transition-all hover:bg-accent/50 hover:border-primary/50 hover:shadow-lg">
          <div class="mb-4 inline-block px-3 py-1 bg-primary/10 text-primary text-sm font-medium rounded-full">
            The Application
          </div>
          <h3 class="text-2xl font-bold mb-3 group-hover:text-primary transition-colors">SEO Development</h3>
          <p class="text-muted-foreground mb-4">Programmatic sites, content systems, and technical SEO infrastructure — all built on automation so they scale without scaling your team.</p>
          <span class="text-sm font-medium text-primary group-hover:underline">Learn more &rarr;</span>
        </a>
      </div>
    </div>
  </section>

  <!-- How It Works -->
  <section class="py-24 bg-muted/30">
    <div class="container max-w-5xl mx-auto px-4 sm:px-6">
      <h2 class="text-3xl font-bold tracking-tight md:text-4xl mb-12 text-center">How It Works</h2>
      <div class="grid gap-8 md:grid-cols-3">
        <div class="text-center">
          <div class="inline-flex items-center justify-center w-12 h-12 rounded-full bg-primary text-primary-foreground font-bold text-lg mb-4">1</div>
          <h3 class="font-bold text-lg mb-2">You tell us what's broken.</h3>
          <p class="text-muted-foreground">The spreadsheet nobody updates. The data that lives in five places. The leads you're not capturing. The reports that take all day.</p>
        </div>
        <div class="text-center">
          <div class="inline-flex items-center justify-center w-12 h-12 rounded-full bg-primary text-primary-foreground font-bold text-lg mb-4">2</div>
          <h3 class="font-bold text-lg mb-2">We build the system.</h3>
          <p class="text-muted-foreground">Custom automations using n8n, Make, Python, AI agents — whatever fits. Connected to the tools you already use.</p>
        </div>
        <div class="text-center">
          <div class="inline-flex items-center justify-center w-12 h-12 rounded-full bg-primary text-primary-foreground font-bold text-lg mb-4">3</div>
          <h3 class="font-bold text-lg mb-2">It runs itself.</h3>
          <p class="text-muted-foreground">You get the output. We maintain the system. Your team focuses on work that actually matters.</p>
        </div>
      </div>
    </div>
  </section>

  <TechShowcase
    badge="Our Stack"
    title="Modern tools. No platform lock-in."
    body={homepage?.showcase_content}
  />

  <CTA
    title={homepage?.cta_title ?? "Got a process that's eating your team's time?"}
    description={homepage?.cta_description ?? "We'll tell you if we can automate it — and what it'll take."}
    cta={{ href: homepage?.cta_button_link ?? "/contact", label: homepage?.cta_button_label ?? "Start a Conversation" }}
  />
</BaseLayout>
