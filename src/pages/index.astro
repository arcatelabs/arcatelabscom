---
import BaseLayout from "@/layouts/BaseLayout.astro";
import Hero from "@/components/sections/Hero.astro";
import Features from "@/components/sections/Features.astro";
import CTA from "@/components/sections/CTA.astro";
import TechShowcase from "@/components/sections/TechShowcase.astro";
import directus from "@/lib/directus";
import { readSingleton } from "@directus/sdk";

let homepage: any = null;
try {
  homepage = await directus.request(readSingleton("homepage"));
} catch {
  // Collection empty or doesn't exist — use defaults
}
---

<BaseLayout title="Arcate Labs" description="Arcate Labs builds automation systems — custom workflows, SEO infrastructure, and AI-powered systems designed to run without you.">
  <Hero
    title={homepage?.headline ?? "We build automation systems that do the work for you."}
    subtitle={homepage?.tagline ?? "Custom workflows, SEO infrastructure, and AI-powered systems — designed to run without you babysitting them."}
    primaryCta={{ href: homepage?.hero_primary_cta_link ?? "/contact", label: homepage?.hero_primary_cta_label ?? "Start a Conversation" }}
    secondaryCta={{ href: homepage?.hero_secondary_cta_link ?? "/solutions", label: homepage?.hero_secondary_cta_label ?? "See Our Solutions" }}
  />

  <!-- Built With -->
  <section class="py-8 border-b border-border/50">
    <div class="container max-w-5xl mx-auto px-4 sm:px-6 flex flex-col sm:flex-row items-center gap-4 sm:gap-8">
      <span class="text-sm text-muted-foreground tracking-wide uppercase shrink-0">Built with</span>
      <div class="flex flex-wrap items-center gap-6 sm:gap-8">
        <div class="flex items-center gap-2 text-muted-foreground">
          <svg class="w-5 h-5" viewBox="0 0 24 24" aria-hidden="true"><path d="m4.7144 15.9555 4.7174-2.6471.079-.2307-.079-.1275h-.2307l-.7893-.0486-2.6956-.0729-2.3375-.0971-2.2646-.1214-.5707-.1215-.5343-.7042.0546-.3522.4797-.3218.686.0608 1.5179.1032 2.2767.1578 1.6514.0972 2.4468.255h.3886l.0546-.1579-.1336-.0971-.1032-.0972L6.973 9.8356l-2.55-1.6879-1.3356-.9714-.7225-.4918-.3643-.4614-.1578-1.0078.6557-.7225.8803.0607.2246.0607.8925.686 1.9064 1.4754 2.4893 1.8336.3643.3035.1457-.1032.0182-.0728-.164-.2733-1.3539-2.4467-1.445-2.4893-.6435-1.032-.17-.6194c-.0607-.255-.1032-.4674-.1032-.7285L6.287.1335 6.6997 0l.9957.1336.419.3642.6192 1.4147 1.0018 2.2282 1.5543 3.0296.4553.8985.2429.8318.091.255h.1579v-.1457l.1275-1.706.2368-2.0947.2307-2.6957.0789-.7589.3764-.9107.7468-.4918.5828.2793.4797.686-.0668.4433-.2853 1.8517-.5586 2.9021-.3643 1.9429h.2125l.2429-.2429.9835-1.3053 1.6514-2.0643.7286-.8196.85-.9046.5464-.4311h1.0321l.759 1.1293-.34 1.1657-1.0625 1.3478-.8804 1.1414-1.2628 1.7-.7893 1.36.0729.1093.1882-.0183 2.8535-.607 1.5421-.2794 1.8396-.3157.8318.3886.091.3946-.3278.8075-1.967.4857-2.3072.4614-3.4364.8136-.0425.0304.0486.0607 1.5482.1457.6618.0364h1.621l3.0175.2247.7892.522.4736.6376-.079.4857-1.2142.6193-1.6393-.3886-3.825-.9107-1.3113-.3279h-.1822v.1093l1.0929 1.0686 2.0035 1.8092 2.5075 2.3314.1275.5768-.3218.4554-.34-.0486-2.2039-1.6575-.85-.7468-1.9246-1.621h-.1275v.17l.4432.6496 2.3436 3.5214.1214 1.0807-.17.3521-.6071.2125-.6679-.1214-1.3721-1.9246L14.38 17.959l-1.1414-1.9428-.1397.079-.674 7.2552-.3156.3703-.7286.2793-.6071-.4614-.3218-.7468.3218-1.4753.3886-1.9246.3157-1.53.2853-1.9004.17-.6314-.0121-.0425-.1397.0182-1.4328 1.9672-2.1796 2.9446-1.7243 1.8456-.4128.164-.7164-.3704.0667-.6618.4008-.5889 2.386-3.0357 1.4389-1.882.929-1.0868-.0062-.1579h-.0546l-6.3385 4.1164-1.1293.1457-.4857-.4554.0608-.7467.2307-.2429 1.9064-1.3114Z" fill="#D97757"/></svg>
          <span class="text-sm font-medium">Claude Code</span>
        </div>
        <div class="flex items-center gap-2 text-muted-foreground">
          <svg class="w-5 h-5" viewBox="0 0 24 24" aria-hidden="true"><path d="M11.992 1.966c-.434 0-.87.086-1.28.257L1.779 5.917c-.503.208-.49.908.012 1.116l8.982 3.558a3.266 3.266 0 0 0 2.454 0l8.982-3.558c.503-.196.503-.908.012-1.116l-8.957-3.694a3.255 3.255 0 0 0-1.272-.257zM23.4 8.056a.589.589 0 0 0-.222.045l-10.012 3.877a.612.612 0 0 0-.38.564v8.896a.6.6 0 0 0 .821.552L23.62 18.1a.583.583 0 0 0 .38-.551V8.653a.6.6 0 0 0-.6-.596zM.676 8.095a.644.644 0 0 0-.48.19C.086 8.396 0 8.53 0 8.69v8.355c0 .442.515.737.908.54l6.27-3.006.307-.147 2.969-1.436c.466-.22.43-.908-.061-1.092L.883 8.138a.57.57 0 0 0-.207-.044z" fill="#18BFFF"/></svg>
          <span class="text-sm font-medium">Airtable</span>
        </div>
        <div class="flex items-center gap-2 text-muted-foreground">
          <svg class="w-5 h-5" viewBox="0 0 24 24" aria-hidden="true"><path d="M14.23 12.004a2.236 2.236 0 0 1-2.235 2.236 2.236 2.236 0 0 1-2.236-2.236 2.236 2.236 0 0 1 2.235-2.236 2.236 2.236 0 0 1 2.236 2.236zm2.648-10.69c-1.346 0-3.107.96-4.888 2.622-1.78-1.653-3.542-2.602-4.887-2.602-.41 0-.783.093-1.106.278-1.375.793-1.683 3.264-.973 6.365C1.98 8.917 0 10.42 0 12.004c0 1.59 1.99 3.097 5.043 4.03-.704 3.113-.39 5.588.988 6.38.32.187.69.275 1.102.275 1.345 0 3.107-.96 4.888-2.624 1.78 1.654 3.542 2.603 4.887 2.603.41 0 .783-.09 1.106-.275 1.374-.792 1.683-3.263.973-6.365C22.02 15.096 24 13.59 24 12.004c0-1.59-1.99-3.097-5.043-4.032.704-3.11.39-5.587-.988-6.38-.318-.184-.688-.277-1.092-.278zm-.005 1.09v.006c.225 0 .406.044.558.127.666.382.955 1.835.73 3.704-.054.46-.142.945-.25 1.44-.96-.236-2.006-.417-3.107-.534-.66-.905-1.345-1.727-2.035-2.447 1.592-1.48 3.087-2.292 4.105-2.295zm-9.77.02c1.012 0 2.514.808 4.11 2.28-.686.72-1.37 1.537-2.02 2.442-1.107.117-2.154.298-3.113.538-.112-.49-.195-.964-.254-1.42-.23-1.868.054-3.32.714-3.707.19-.09.4-.127.563-.132zm4.882 3.05c.455.468.91.992 1.36 1.564-.44-.02-.89-.034-1.345-.034-.46 0-.915.01-1.36.034.44-.572.895-1.096 1.345-1.565zM12 8.1c.74 0 1.477.034 2.202.093.406.582.802 1.203 1.183 1.86.372.64.71 1.29 1.018 1.946-.308.655-.646 1.31-1.013 1.95-.38.66-.773 1.288-1.18 1.87-.728.063-1.466.098-2.21.098-.74 0-1.477-.035-2.202-.093-.406-.582-.802-1.204-1.183-1.86-.372-.64-.71-1.29-1.018-1.946.303-.657.646-1.313 1.013-1.954.38-.66.773-1.286 1.18-1.868.728-.064 1.466-.098 2.21-.098zm-3.635.254c-.24.377-.48.763-.704 1.16-.225.39-.435.782-.635 1.174-.265-.656-.49-1.31-.676-1.947.64-.15 1.315-.283 2.015-.386zm7.26 0c.695.103 1.365.23 2.006.387-.18.632-.405 1.282-.66 1.933-.2-.39-.41-.783-.64-1.174-.225-.392-.465-.774-.705-1.146zm3.063.675c.484.15.944.317 1.375.498 1.732.74 2.852 1.708 2.852 2.476-.005.768-1.125 1.74-2.857 2.475-.42.18-.88.342-1.355.493-.28-.958-.646-1.956-1.1-2.98.45-1.017.81-2.01 1.085-2.964zm-13.395.004c.278.96.645 1.957 1.1 2.98-.45 1.017-.812 2.01-1.086 2.964-.484-.15-.944-.318-1.37-.5-1.732-.737-2.852-1.706-2.852-2.474 0-.768 1.12-1.742 2.852-2.476.42-.18.88-.342 1.356-.494zm11.678 4.28c.265.657.49 1.312.676 1.948-.64.157-1.316.29-2.016.39.24-.375.48-.762.705-1.158.225-.39.435-.788.636-1.18zm-9.945.02c.2.392.41.783.64 1.175.23.39.465.772.705 1.143-.695-.102-1.365-.23-2.006-.386.18-.63.406-1.282.66-1.933zM17.92 16.32c.112.493.2.968.254 1.423.23 1.868-.054 3.32-.714 3.708-.147.09-.338.128-.563.128-1.012 0-2.514-.807-4.11-2.28.686-.72 1.37-1.536 2.02-2.44 1.107-.118 2.154-.3 3.113-.54zm-11.83.01c.96.234 2.006.415 3.107.532.66.905 1.345 1.727 2.035 2.446-1.595 1.483-3.092 2.295-4.11 2.295-.22-.005-.406-.05-.553-.132-.666-.38-.955-1.834-.73-3.703.054-.46.142-.944.25-1.438zm4.56.64c.44.02.89.034 1.345.034.46 0 .915-.01 1.36-.034-.44.572-.895 1.095-1.345 1.565-.455-.47-.91-.993-1.36-1.565z" fill="#61DAFB"/></svg>
          <span class="text-sm font-medium">React</span>
        </div>
        <div class="flex items-center gap-2 text-muted-foreground">
          <svg class="w-5 h-5" viewBox="0 0 24 24" aria-hidden="true"><path d="M21.4737 5.6842c-1.1772 0-2.1663.8051-2.4468 1.8947h-2.8955c-1.235 0-2.289.893-2.492 2.111l-.1038.623a1.263 1.263 0 0 1-1.246 1.0555H11.289c-.2805-1.0896-1.2696-1.8947-2.4468-1.8947s-2.1663.8051-2.4467 1.8947H4.973c-.2805-1.0896-1.2696-1.8947-2.4468-1.8947C1.1311 9.4737 0 10.6047 0 12s1.131 2.5263 2.5263 2.5263c1.1772 0 2.1663-.8051 2.4468-1.8947h1.4223c.2804 1.0896 1.2696 1.8947 2.4467 1.8947 1.1772 0 2.1663-.8051 2.4468-1.8947h1.0008a1.263 1.263 0 0 1 1.2459 1.0555l.1038.623c.203 1.218 1.257 2.111 2.492 2.111h.3692c.2804 1.0895 1.2696 1.8947 2.4468 1.8947 1.3952 0 2.5263-1.131 2.5263-2.5263s-1.131-2.5263-2.5263-2.5263c-1.1772 0-2.1664.805-2.4468 1.8947h-.3692a1.263 1.263 0 0 1-1.246-1.0555l-.1037-.623A2.52 2.52 0 0 0 13.9607 12a2.52 2.52 0 0 0 .821-1.4794l.1038-.623a1.263 1.263 0 0 1 1.2459-1.0555h2.8955c.2805 1.0896 1.2696 1.8947 2.4468 1.8947 1.3952 0 2.5263-1.131 2.5263-2.5263s-1.131-2.5263-2.5263-2.5263m0 1.2632a1.263 1.263 0 0 1 1.2631 1.2631 1.263 1.263 0 0 1-1.2631 1.2632 1.263 1.263 0 0 1-1.2632-1.2632 1.263 1.263 0 0 1 1.2632-1.2631M2.5263 10.7368A1.263 1.263 0 0 1 3.7895 12a1.263 1.263 0 0 1-1.2632 1.2632A1.263 1.263 0 0 1 1.2632 12a1.263 1.263 0 0 1 1.2631-1.2632m6.3158 0A1.263 1.263 0 0 1 10.1053 12a1.263 1.263 0 0 1-1.2632 1.2632A1.263 1.263 0 0 1 7.579 12a1.263 1.263 0 0 1 1.2632-1.2632m10.1053 3.7895a1.263 1.263 0 0 1 1.2631 1.2632 1.263 1.263 0 0 1-1.2631 1.2631 1.263 1.263 0 0 1-1.2632-1.2631 1.263 1.263 0 0 1 1.2632-1.2632" fill="#EA4B71"/></svg>
          <span class="text-sm font-medium">n8n</span>
        </div>
        <div class="flex items-center gap-2 text-muted-foreground">
          <svg class="w-5 h-5" viewBox="0 0 24 24" aria-hidden="true"><path d="M14.727 6.727H14V0H4.91c-.905 0-1.637.732-1.637 1.636v20.728c0 .904.732 1.636 1.636 1.636h14.182c.904 0 1.636-.732 1.636-1.636V6.727h-6zm-.545 10.455H7.09v-1.364h7.09v1.364zm2.727-3.273H7.091v-1.364h9.818v1.364zm0-3.273H7.091V9.273h9.818v1.363zM14.727 6h6l-6-6v6z" fill="#4285F4"/></svg>
          <span class="text-sm font-medium">Google Docs</span>
        </div>
      </div>
    </div>
  </section>

  <!-- What We Do -->
  <section class="py-24">
    <div class="container max-w-3xl mx-auto px-4 sm:px-6">
      <h2 class="text-3xl font-bold tracking-tight md:text-4xl mb-8">What We Do</h2>
      <div class="space-y-6 text-lg text-muted-foreground leading-relaxed">
        <p>
          Arcate Labs is an automation-first development studio. We build the systems that connect your tools, generate your leads, and handle the work your team shouldn't be doing manually.
        </p>
        <p>
          We started by building automations for SEO — content pipelines, programmatic sites, data enrichment workflows. It turns out those same systems solve problems in every industry. Now we build automation for anyone who's tired of doing things the hard way.
        </p>
      </div>
    </div>
  </section>

  <Features
    title={homepage?.features_title ?? "Capabilities"}
    subtitle={homepage?.features_subtitle ?? "Scalable systems across search, engineering, and automation."}
    features={[
      { title: "SEO & Search Architecture", description: "Designing scalable search structures that align with user intent and support long-term discoverability.", icon: "globe" },
      { title: "Programmatic Site Development", description: "Building flexible, data-driven sites designed to scale across markets, locations, or service categories.", icon: "zap" },
      { title: "Workflow Automation", description: "Automating how demand is captured, filtered, and delivered to reduce friction and manual handling.", icon: "chart" },
      { title: "Data-Driven Growth Systems", description: "Using performance data to inform system structure, iteration, and expansion.", icon: "shield" },
      { title: "Custom Demand Infrastructure", description: "Designing purpose-built systems tailored to specific industries, constraints, or operational goals.", icon: "lock" },
    ]}
  />

  <!-- Two Practices, One Engine -->
  <section class="py-24">
    <div class="container max-w-5xl mx-auto px-4 sm:px-6">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-bold leading-[1.1] md:text-5xl">Two Practices, One Engine</h2>
      </div>
      <div class="grid gap-8 md:grid-cols-2">
        <a href="/solutions/automation" class="group rounded-lg border bg-card p-8 transition-all hover:bg-accent/50 hover:border-primary/50 hover:shadow-lg">
          <div class="mb-4 inline-block px-3 py-1 bg-primary/10 text-primary text-sm font-medium rounded-full">
            The Engine
          </div>
          <h3 class="text-2xl font-bold mb-3 group-hover:text-primary transition-colors">Automation Engineering</h3>
          <p class="text-muted-foreground mb-4">Custom workflows, system integrations, and AI-powered automation that eliminate manual work and connect your tools into one system.</p>
          <span class="text-sm font-medium text-primary group-hover:underline">Learn more &rarr;</span>
        </a>
        <a href="/solutions/seo" class="group rounded-lg border bg-card p-8 transition-all hover:bg-accent/50 hover:border-primary/50 hover:shadow-lg">
          <div class="mb-4 inline-block px-3 py-1 bg-primary/10 text-primary text-sm font-medium rounded-full">
            The Application
          </div>
          <h3 class="text-2xl font-bold mb-3 group-hover:text-primary transition-colors">SEO Development</h3>
          <p class="text-muted-foreground mb-4">Programmatic sites, content systems, and technical SEO infrastructure — all built on automation so they scale without scaling your team.</p>
          <span class="text-sm font-medium text-primary group-hover:underline">Learn more &rarr;</span>
        </a>
      </div>
    </div>
  </section>

  <!-- We Measure What Matters -->
  <section class="py-24">
    <div class="container max-w-3xl mx-auto px-4 sm:px-6">
      <h2 class="text-3xl font-bold tracking-tight md:text-4xl mb-8">We Measure What Matters</h2>
      <div class="space-y-6 text-lg text-muted-foreground leading-relaxed">
        <p>
          We measure what matters to your business — not vanity metrics. Leads generated, phone calls booked, directions requested, emails captured, response times, ticket closure rates, conversion rates by rep — whatever KPI drives your revenue, that's what we optimize around.
        </p>
        <p>
          We build the systems to track it, automate as much of the pipeline as possible, and scale what's working.
        </p>
      </div>
      <blockquote class="mt-12 border-l-4 border-primary pl-6 py-4">
        <p class="text-xl font-medium italic text-foreground mb-2">
          "Without data, you're just another person with an opinion."
        </p>
        <footer class="text-muted-foreground">
          — W. Edwards Deming
        </footer>
        <a href="/blog/without-data" class="text-sm font-medium text-primary hover:underline mt-2 inline-block">
          This quote shaped how we build everything &rarr;
        </a>
      </blockquote>
    </div>
  </section>

  <!-- How It Works -->
  <section class="py-24 bg-muted/30">
    <div class="container max-w-5xl mx-auto px-4 sm:px-6">
      <h2 class="text-3xl font-bold tracking-tight md:text-4xl mb-12 text-center">How It Works</h2>
      <div class="grid gap-8 md:grid-cols-3">
        <div class="text-center">
          <div class="inline-flex items-center justify-center w-12 h-12 rounded-full bg-primary text-primary-foreground font-bold text-lg mb-4">1</div>
          <h3 class="font-bold text-lg mb-2">You tell us what's broken.</h3>
          <p class="text-muted-foreground">The spreadsheet nobody updates. The data that lives in five places. The leads you're not capturing. The reports that take all day.</p>
        </div>
        <div class="text-center">
          <div class="inline-flex items-center justify-center w-12 h-12 rounded-full bg-primary text-primary-foreground font-bold text-lg mb-4">2</div>
          <h3 class="font-bold text-lg mb-2">We build the system.</h3>
          <p class="text-muted-foreground">Custom automations using n8n, Make, Python, AI agents — whatever fits. Connected to the tools you already use.</p>
        </div>
        <div class="text-center">
          <div class="inline-flex items-center justify-center w-12 h-12 rounded-full bg-primary text-primary-foreground font-bold text-lg mb-4">3</div>
          <h3 class="font-bold text-lg mb-2">It runs itself.</h3>
          <p class="text-muted-foreground">You get the output. We maintain the system. Your team focuses on work that actually matters.</p>
        </div>
      </div>
    </div>
  </section>

  <TechShowcase
    badge="Our Stack"
    title="Modern tools. No platform lock-in."
    body={homepage?.showcase_content}
  />

  <CTA
    title={homepage?.cta_title ?? "Got a process that's eating your team's time?"}
    description={homepage?.cta_description ?? "We'll tell you if we can automate it — and what it'll take."}
    cta={{ href: homepage?.cta_button_link ?? "/contact", label: homepage?.cta_button_label ?? "Start a Conversation" }}
  />
</BaseLayout>
